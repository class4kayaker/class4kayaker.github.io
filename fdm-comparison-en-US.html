<!DOCTYPE html><html lang="en"><head><title>Jonathan Robey</title><meta charset="utf-8"><link href="https://www.math.ucdavis.edu/~jrobey/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jonathan Robey Full Atom Feed"><link href="https://www.math.ucdavis.edu/~jrobey/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Jonathan Robey Categories Atom Feed"><meta http-equiv="Content-Security-Policy" content="script-src 'self' https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/"><meta http-equiv="Content-Security-Policy" content="require-sri-for script style"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" integrity="sha384-aO3lPZPD09+Yve9t+5/LqmlEZSO+6c5M8lQ4i25CcM/T7VVArjlo5KCLg0awBRPz" href="https://www.math.ucdavis.edu/~jrobey/theme/css/style.css?5a2d33"><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-CABIusojVGLXKWOcdRP7wwh3SC7gjAbMmAnii19ZRH6QOsLiM6NIJ7Mb4BjfkQLU" crossorigin="anonymous" async></script></head><body id="index" class="home"><header id="banner" class="body"><h1><a href="https://www.math.ucdavis.edu/~jrobey/">Jonathan Robey <strong></strong></a></h1></header><div id="navigation"><nav id="menu"><h3>Information</h3><ul><li><a href="https://www.math.ucdavis.edu/~jrobey/">About Jonathan Robey</a></li><li><a href="https://www.math.ucdavis.edu/~jrobey/pages/ta-info-en-US.html">TA Information</a></li><li><a href="https://www.math.ucdavis.edu/~jrobey/pages/research-en-US.html">Research</a></li></ul><h3>Posts</h3><ul><li><a href="https://www.math.ucdavis.edu/~jrobey/category/graduate-school.html">Graduate School</a></li><li><a href="https://www.math.ucdavis.edu/~jrobey/category/research.html">Research</a></li><li class="active"><a href="https://www.math.ucdavis.edu/~jrobey/category/teaching.html">Teaching</a></li></ul></nav></div><div id="contentpane"><section id="content" class="body"><header><h2 class="entry-title"><a href="https://www.math.ucdavis.edu/~jrobey/fdm-comparison-en-US.html" rel="bookmark" title="Permalink to A Comparison of Finite Difference Methods">A Comparison of Finite Difference Methods</a></h2></header><footer class="post-info"><time class="published" datetime="2018-04-29T10:00:00-07:00"> Sun 29 April 2018 </time><span class="authors">By Jonathan Robey</span></footer><div class="entry-content"><h1 id="introduction">Introduction</h1><p>Among the earliest applications of computers to mathematics is approximating the solution of partial differential equations. By the nature of digital computers, it is necessary to describe the problem such that the solution can be expressed by a finite set of floating point values. One of the oldest methods for doing this is to express the approximate solution as the values at a set of specified points, which results in what is referred to as a <em>Finite Difference Method</em>.</p><h1 id="advection-equation">Advection Equation</h1><p>One of the standard basic test problems for a new <em>finite difference method</em> is the advection equation:</p><p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>u</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>a</mi><mfrac><mrow><mi>d</mi><mi>u</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{du}{dt}+a\frac{du}{dx}=0</annotation></semantics></math></p><p>This equation is used because it simultaneously has a simple analytic solution to the initial value problem on a periodic domain, and this simplicity is not inherently exposed to the solution method.</p><p>Given the initial state is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>u</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">u(x,0)=u_0(x)</annotation></semantics></math>, the analytic solution is</p><p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>u</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mi>t</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">u(x,t)=u_0(x-at)</annotation></semantics></math></p><p>This then makes the comparison of the final result of the algorithm to the true solution possible for a large range of solution types.</p><p>Analysis of a general Finite Difference algorithm suggests that the expected error for this equation can be expected to be related to the number of continuous spatial derivatives in the initial solution.</p><p>Below, we examine the results of a number of standard finite difference methods as applied to this differential equation with a number of initial conditions for a spacing of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mfrac><mn>1</mn><mn>64</mn></mfrac></mrow><annotation encoding="application/x-tex">h=\frac{1}{64}</annotation></semantics></math>.</p><h2 id="test-problems">Test Problems</h2><dl><dt>Sine Wave</dt><dd><p>Smooth initial data with small derivatives</p></dd><dt>Gaussian Pulse</dt><dd><p>Smooth initial data with large derivatives</p></dd><dt>Triangle Wave</dt><dd><p>Continuous initial data with no continuous derivatives</p></dd><dt>Square Wave</dt><dd><p>Discontinuous initial data</p></dd></dl><h2 id="methods">Methods</h2><dl><dt>Sol</dt><dd><p>The true solution to the advection equation</p></dd><dt>W($N)T($M)</dt><dd><p>WENO<span class="citation" data-cites="GSJ-CWS:1996">[<a href="#ref-GSJ-CWS:1996" role="doc-biblioref">1</a>]</span> method of order ($N) in space with TVD Runge-Kutta time stepping <span class="citation" data-cites="SG-CWS:1998">[<a href="#ref-SG-CWS:1998" role="doc-biblioref">2</a>]</span> of order ($M)</p></dd><dt>F($N)</dt><dd><p>Fromm's method with CFL number <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>/</mi><mn>10</mn></mrow><annotation encoding="application/x-tex">N/10</annotation></semantics></math></p></dd><dt>FvL($N)</dt><dd><p>Fromm's method with CFL number <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>/</mi><mn>10</mn></mrow><annotation encoding="application/x-tex">N/10</annotation></semantics></math> using the van Leer Slope Limiter</p></dd><dt>FCT</dt><dd><p>Flux Corrected Transport <span class="citation" data-cites="STZ:1979">[<a href="#ref-STZ:1979" role="doc-biblioref">3</a>]</span> using the Upwind and Lax-Wendroff</p></dd><dt>LW4</dt><dd><p>4th order Lax-Wendroff <span class="citation" data-cites="STZ:1984">[<a href="#ref-STZ:1984" role="doc-biblioref">4</a>]</span> with the required artificial viscosity for stability</p></dd></dl><h2 id="sine-wave">Sine Wave</h2><figure><img src="https://www.math.ucdavis.edu/~jrobey/images/AdvPlots/Adv-UniPlot-CIE.svg" alt><figcaption>Solutions after 9 advection cycles</figcaption></figure><figure><img src="https://www.math.ucdavis.edu/~jrobey/images/AdvPlots/Adv-UniPlotE-CIE.svg" alt><figcaption>Errors after 9 advection cycles</figcaption></figure><h2 id="gaussian-pulse">Gaussian Pulse</h2><figure><img src="https://www.math.ucdavis.edu/~jrobey/images/AdvPlots/Adv-UniPlot-CIH.svg" alt><figcaption>Solutions after 9 advection cycles</figcaption></figure><figure><img src="https://www.math.ucdavis.edu/~jrobey/images/AdvPlots/Adv-UniPlotE-CIH.svg" alt><figcaption>Errors after 9 advection cycles</figcaption></figure><h2 id="triangle-wave">Triangle Wave</h2><figure><img src="https://www.math.ucdavis.edu/~jrobey/images/AdvPlots/Adv-UniPlot-C0.svg" alt><figcaption>Solutions after 9 advection cycles</figcaption></figure><figure><img src="https://www.math.ucdavis.edu/~jrobey/images/AdvPlots/Adv-UniPlotE-C0.svg" alt><figcaption>Errors after 9 advection cycle</figcaption></figure><h2 id="square-wave">Square Wave</h2><figure><img src="https://www.math.ucdavis.edu/~jrobey/images/AdvPlots/Adv-UniPlot-D.svg" alt><figcaption>Solutions after 9 advection cycles</figcaption></figure><figure><img src="https://www.math.ucdavis.edu/~jrobey/images/AdvPlots/Adv-UniPlotE-D.svg" alt><figcaption>Errors after 9 advection cycles</figcaption></figure><hr><section id="refs" class="references" role="doc-bibliography"><h1 id="references">References</h1><div id="ref-GSJ-CWS:1996"><p>[1] G.-S. Jiang, C.-W. Shu, Efficient implementation of weighted eno schemes, Journal of Computational Physics. 126 (1996) 202–228. <a href="https://doi.org/https://doi.org/10.1006/jcph.1996.0130">https://doi.org/https://doi.org/10.1006/jcph.1996.0130</a>.</p></div><div id="ref-SG-CWS:1998"><p>[2] S. Gottlieb, C.-W. Shu, Total variation diminishing runge-kutta schemes, Mathematics of Computation of the American Mathematical Society. 67 (1998) 73–85. <a href="https://doi.org/10.1090/s0025-5718-98-00913-2">https://doi.org/10.1090/s0025-5718-98-00913-2</a>.</p></div><div id="ref-STZ:1979"><p>[3] S.T. Zalesak, Fully multidimensional flux-corrected transport algorithms for fluids, Journal of Computational Physics. 31 (1979) 335–362.</p></div><div id="ref-STZ:1984"><p>[4] S. Zalesak, A physical interpretation of the richtmyer two-step lax-wendroff scheme, and its generalization to higher spatial order, Advances in Computer Methods for Partial Differential Equations. 19 (1984).</p></div></section></div></section></div><footer id="contentinfo" class="body"><address id="about" class="vcard body"> Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>. </address></footer></body></html>